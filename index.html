<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>ARC RAIDERS | Item Value Database</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght+500;700&display=swap');

        :root {
            --bg-ivory: #f2ede4; 
            --sidebar-ivory: #e6e0d4; 
            --card-white: #f2ede42f;
            --text-main: #3a352a;
            --border-tan: #dcd3c1;
            --point-blue: #45a29e;
            --point-pink: #d33f6a;
            
            --tier-s: #f1c40f; 
            --tier-a: #d33f6a; 
            
            --tier-b: #3498db;
            --tier-c: #27ae60;
            --tier-d: #8c8c8c;
            
            --padding-base: 20px; 
            --fixed-height-mobile: 80px; 
            --sidebar-width-desktop: 340px; 
        }

        html {
            overflow-x: hidden; 
            overflow-y: auto;
        }
        
        body {
            background-color: var(--bg-ivory);
            color: var(--text-main);
            font-family: 'Rajdhani', sans-serif;
            margin: 0;
            min-height: 100vh;
            overflow-x: hidden; 
            overflow-y: auto; 
        }

        /* ---------------------------------- */
        /* ë°ìŠ¤í¬í†± ê¸°ë³¸ ë ˆì´ì•„ì›ƒ (769px ì´ìƒ) */
        /* ---------------------------------- */
        #sidebar {
            width: var(--sidebar-width-desktop);
            background: var(--sidebar-ivory);
            border-right: 1px solid var(--border-tan);
            display: flex;
            flex-direction: column;
            box-shadow: 4px 0 15px rgba(0,0,0,0.05);
            z-index: 1000;
            flex-shrink: 0;
            position: fixed; 
            top: 0; 
            left: 0;
            height: 100vh; 
        }
        
        .scrollable-content {
            padding: var(--padding-base);
            padding-bottom: 0;
            flex-grow: 1;
            overflow-y: auto; /* <--- ìˆ˜ì •ë¨: ì•„ì´í…œì´ ë§ì„ ê²½ìš° ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
        }

        .logo-container {
            width: 100%;
            height: 180px;
            background: #ffffff;
            border-bottom: 2px solid var(--border-tan);
            overflow: hidden;
            flex-shrink: 0;
        }

        .logo-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        #mobile-header-fixed,
        .logo-container-mobile {
            display: none;
        }

        #reset-container-desktop {
            flex-shrink: 0;
            padding: var(--padding-base);
            padding-top: 10px;
            background: var(--sidebar-ivory);
            border-top: 1px solid var(--border-tan);
            box-shadow: 0 -4px 10px rgba(0,0,0,0.03);
            position: relative; 
        }
        
        #reset-container-mobile {
            display: none; 
        }

        .main-content { 
            flex-grow: 1; 
            overflow-y: visible;
            margin-left: var(--sidebar-width-desktop); 
            padding: 0 40px 40px 40px; 
        }

        /* ìµœìƒë‹¨ ê³ ì • í—¤ë” ì»¨í…Œì´ë„ˆ */
        #fixed-header-container {
            position: fixed;
            top: 0;
            right: 0;
            z-index: 9999; /* Z-index ë†’ì„ */
            background: var(--bg-ivory);
            border-bottom: 1px solid var(--border-tan);
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            padding: 15px 40px;
            box-sizing: border-box;
            left: var(--sidebar-width-desktop);
            height: 170px; /* ë°ìŠ¤í¬í†± í—¤ë” ë†’ì´ */
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* ê¸ˆì•¡ ë°•ìŠ¤ */
        .net-worth-box {
            background: #ffffff;
            border-radius: 12px;
            padding: 10px 15px;
            border: 1px solid var(--border-tan);
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .net-worth-label {
            font-size: 0.75rem; 
            opacity: 0.7;
            font-family: 'Orbitron', sans-serif;
        }
        .total-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            text-align: right;
            color: var(--point-blue);
            font-weight: bold;
        }

        /* ê²€ìƒ‰ ê·¸ë£¹ */
        .search-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px; 
            width: 100%;
        }

        #go-top-button {
            background: var(--point-blue);
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            line-height: 45px;
            text-align: center;
            cursor: pointer;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s, margin-right 0.3s, width 0.3s, min-width 0.3s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            width: 0; 
            min-width: 0;
            margin-right: 0;
            padding: 0;
            flex-shrink: 0;
        }
        
        #go-top-button.visible {
             width: 45px;
             min-width: 45px;
             margin-right: 10px;
             opacity: 1;
             visibility: visible;
        }
        
        #go-top-button:hover {
            background: #398884;
        }

        #searchInput {
            flex-grow: 1; 
            padding: 12px 20px; 
            border-radius: 25px; 
            border: 1px solid var(--border-tan); 
            font-family: 'Rajdhani', sans-serif; 
            font-size: 1rem; 
            background: #fff;
            box-sizing: border-box; 
            height: 45px;
        }

        /* í•„í„° ì»¨í…Œì´ë„ˆ */
        #filter-container {
            background: #ffffff;
            border-radius: 12px;
            padding: 10px 15px;
            border: 1px solid var(--border-tan);
        }

        .filter-group {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 10px 20px;
        }

        .filter-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.8rem;
            color: var(--point-pink);
            min-width: 50px;
            flex-shrink: 0;
            /* Flexbox ì¶”ê°€í•˜ì—¬ labelê³¼ iconì„ ì •ë ¬ */
            display: flex; 
            align-items: center;
        }

        .filter-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .filter-option input[type="checkbox"] {
            margin-right: 5px;
            accent-color: var(--point-blue);
            width: 14px;
            height: 14px;
        }

        /* êµ¬ë¶„ì„  ë° í—¤ë” */
        .section-header {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.85rem;
            color: var(--text-main);
            background: #ffffff;
            padding: 8px 15px;
            border-radius: 20px;
            text-align: center;
            border: 1px solid var(--border-tan);
            margin-bottom: 20px;
            letter-spacing: 1px;
        }
        
        .mobile-separator {
            width: 100%;
            height: 1px;
            background: var(--border-tan);
            margin: 15px 0 25px 0;
            display: none; 
        }
        
        .acquisition-list-header {
             display: none; 
        }

        /* ìœ„ì‹œë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ (ë°ìŠ¤í¬í†± ê¸°ë³¸) */
        #wishlist { 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
        }

        .wishlist-item {
            background: #ffffff;
            border-radius: 8px;
            padding: 8px; 
            display: flex;
            align-items: center;
            gap: 8px; 
            border: 1px solid var(--border-tan);
        }

        .wish-icon { 
            width: 35px; 
            height: 35px; 
            border-radius: 4px; 
            object-fit: contain; 
            background: #f9f9f9; 
            flex-shrink: 0;
        }

        .wishlist-item > div { width: 100%; }
        .wishlist-item > div > div:first-child { font-weight:bold; font-size: 0.8rem; }
        .wishlist-item > div > div:last-child { color:var(--point-blue); font-weight:bold; font-size: 0.75rem; }

        /* ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ */
        .btn-show-modal, .btn-reset { 
            border: none;
            padding: 12px;
            width: 100%; 
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            border-radius: 8px;
            font-weight: bold;
        }
        .btn-show-modal {
            background: var(--point-blue);
            color: #fff;
            margin-bottom: 10px; 
            position: relative; 
        }
        .btn-reset {
            background: var(--point-pink);
            color: #fff;
        }
        
        /* ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .item-count-badge {
            position: absolute;
            top: -10px; 
            right: 10px; 
            background: var(--point-pink);
            color: #fff;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.65rem; 
            font-weight: bold;
            padding: 6px 10px; 
            border-radius: 12px;
            z-index: 10;
            min-width: 40px; 
            white-space: nowrap; 
            text-align: center;
            opacity: 0.9;
            transition: opacity 0.3s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: none; 
        }

        /* ê·¸ë¦¬ë“œ ë° ì¹´ë“œ */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 30px;
        }

        .card {
            background: var(--card-white);
            border-radius: 15px;
            padding: 25px 20px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid var(--border-tan);
            position: relative;
        }
        
        .card::before {
            position: absolute;
            top: 15px; left: 50%;
            transform: translateX(-50%);
            font-family: 'Orbitron', sans-serif;
            font-size: 0.65rem;
            background: #8a8271;
            color: #fff;
            padding: 2px 12px;
            border-radius: 10px;
            letter-spacing: 1px;
        }
        
        .card.S::before { content: "S TIER"; background: var(--tier-s); }
        .card.A::before { content: "A TIER"; background: var(--tier-a); }
        .card.B::before { content: "B TIER"; background: var(--tier-b); }
        .card.C::before { content: "C TIER"; background: var(--tier-c); }
        .card.D::before { content: "D TIER"; background: var(--tier-d); }

        .card:hover { transform: translateY(-10px); border-color: var(--point-blue); }
        .card.checked { background: #fdfaf5; border: 2px solid var(--point-blue); }

        .img-box { 
            width: 80px;
            height: 80px; 
            margin: 30px auto 15px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            background: #ffffff; 
            border-radius: 12px;
            border: 1px solid #f2ede4;
        }
        
        .img-box img { 
            width: 100%; 
            height: 100%; 
            object-fit: contain;
        }

        .name { 
            font-size: 1.1rem; 
            font-weight: bold; 
            margin-bottom: 8px; 
            height: 45px; 
            overflow: hidden; 
            /* ë‚´ë¶€ ì½˜í…ì¸  ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•œ ì„¤ì • */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            line-height: 1.2; /* ì¤„ ë†’ì´ ì¡°ì • */
        }
        
        /* ìŠ¤íƒ ì¹´ìš´íŠ¸ ë°°ì§€ ìŠ¤íƒ€ì¼ */
        .stack-badge {
            font-family: 'Orbitron', sans-serif;
            font-size: 0.65rem; /* ì‘ì€ í¬ê¸° */
            color: #fff;
            background: #908a7c; /* ì°¨ë¶„í•œ ë°°ê²½ìƒ‰ */
            padding: 1px 5px;
            border-radius: 6px;
            font-weight: normal;
            margin-top: 3px; /* ì´ë¦„ê³¼ ì•½ê°„ ë¶„ë¦¬ */
            display: inline-block;
        }


        .price { font-size: 1.4rem; font-weight: bold; color: var(--point-blue); opacity: 1; }

        .tier-line { height: 6px; border-radius: 3px; margin-top: 20px; }
        .S .tier-line { background: var(--tier-s); }
        .A .tier-line { background: var(--tier-a); }
        .B .tier-line { background: var(--tier-b); }
        .C .tier-line { background: var(--tier-c); }
        .D .tier-line { background: var(--tier-d); }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-thumb { background: var(--border-tan); border-radius: 3px; }
        
        /* --- ëª¨ë‹¬ ìŠ¤íƒ€ì¼ --- */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 10000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: var(--bg-ivory);
            color: var(--text-main);
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            max-width: 900px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
            max-height: 90%;
            overflow-y: auto;
            position: relative;
        }
        
        /* ìƒˆ ëª¨ë‹¬ ì»¨í…ì¸ ë¥¼ ìœ„í•œ í™•ì¥ëœ ìµœëŒ€ ë„ˆë¹„ */
        #materials-modal .modal-content {
            max-width: 1100px;
        }

        .modal-header {
            font-family: 'Orbitron', sans-serif;
            color: var(--text-main); 
            border-bottom: 2px solid var(--border-tan);
            padding-bottom: 15px;
            margin-bottom: 20px;
            display: flex; 
            align-items: baseline;
            justify-content: space-between;
        }
        
        .modal-header-title { font-size: 1.5rem; white-space: nowrap; }
        #modal-total-value-display, #modal-efficiency-info, #modal-materials-info {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem; 
            color: var(--point-blue); 
            font-weight: bold;
            letter-spacing: 1px;
            text-align: right;
            line-height: 1;
        }
        #modal-efficiency-info {
            font-size: 1rem;
            color: #8c8c8c;
            font-weight: normal;
        }
        #modal-materials-info {
            font-size: 1rem;
            color: #8c8c8c;
            font-weight: normal;
        }

        .modal-close {
            position: absolute;
            top: 10px; right: 20px;
            font-size: 2rem; font-weight: bold;
            cursor: pointer; color: var(--point-pink);
            line-height: 1;
        }

        #modal-wishlist-content {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .modal-item-card {
            background: #ffffff;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid var(--border-tan);
            transition: transform 0.2s;
        }
        
        .modal-item-card.S { border-bottom: 5px solid var(--tier-s); }
        .modal-item-card.A { border-bottom: 5px solid var(--tier-a); }
        .modal-item-card.B { border-bottom: 5px solid var(--tier-b); }
        .modal-item-card.C { border-bottom: 5px solid var(--tier-c); }
        .modal-item-card.D { border-bottom: 5px solid var(--tier-d); }

        .modal-item-icon { width: 70px; height: 70px; margin: 0 auto 10px; object-fit: contain; background: #f9f9f9; border-radius: 8px; }
        .modal-item-name { 
            font-weight: bold; 
            font-size: 1rem; 
            margin-bottom: 5px; 
            min-height: 40px; 
            overflow: hidden; 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .modal-item-price { font-family: 'Orbitron', sans-serif; color: var(--point-blue); font-weight: bold; font-size: 1.2rem; }
        
        /* íš¨ìœ¨í‘œ ëª¨ë‹¬ ì „ìš© ìŠ¤íƒ€ì¼ */
        .modal-efficiency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            padding-top: 5px;
        }

        .efficiency-item-card {
            background: #ffffff;
            border-radius: 10px;
            padding: 10px 15px;
            text-align: left;
            border: 1px solid var(--border-tan);
            display: flex;
            align-items: center;
            transition: border 0.2s;
            gap: 10px; /* ì•„ì´ì½˜ê³¼ í…ìŠ¤íŠ¸ ê°„ê²© */
        }
        
        .efficiency-item-card.S { border-left: 5px solid var(--tier-s); }
        .efficiency-item-card.A { border-left: 5px solid var(--tier-a); }
        .efficiency-item-card.B { border-left: 5px solid var(--tier-b); }
        .efficiency-item-card.C { border-left: 5px solid var(--tier-c); }
        .efficiency-item-card.D { border-left: 5px solid var(--tier-d); }

        .efficiency-icon { 
            width: 40px; 
            height: 40px; 
            border-radius: 4px; 
            object-fit: contain; 
            background: #f9f9f9; 
            flex-shrink: 0;
            margin-right: 5px;
        }
        
        .efficiency-rank {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.3rem; 
            color: var(--point-pink);
            font-weight: bold;
            margin-right: 5px;
            width: 40px; 
            text-align: center;
            flex-shrink: 0;
            line-height: 1;
        }

        .efficiency-info {
            flex-grow: 1;
        }
        .efficiency-name {
            font-weight: bold; 
            font-size: 1rem; 
            white-space: nowrap; 
            overflow: hidden; 
            text-overflow: ellipsis;
        }
        .efficiency-value {
            font-family: 'Orbitbitron', sans-serif;
            color: var(--point-blue);
            font-size: 1.1rem;
            font-weight: bold;
        }
        .efficiency-detail {
            font-size: 0.75rem;
            color: #8c8c8c;
        }
        
        /* ---------------------------------- */
        /* ğŸ’¡ ì¶”ê°€ëœ ì¬ë£Œ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        /* ---------------------------------- */
        #modal-materials-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .station-card {
            background: #fff;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--border-tan);
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .station-header {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            color: var(--point-pink);
            border-bottom: 2px solid var(--border-tan);
            padding-bottom: 5px;
            margin-bottom: 10px;
        }
        .station-role {
            font-size: 0.85rem;
            color: #8c8c8c;
            margin-bottom: 10px;
            min-height: 40px;
        }
        .level-section {
            background: #fdfaf5;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 5px solid var(--point-blue);
        }
        .level-header {
            font-weight: bold;
            font-size: 1rem;
            color: var(--text-main);
            margin-bottom: 5px;
        }
        .level-materials {
            font-size: 0.85rem;
            line-height: 1.6; 
            display: flex; 
            flex-wrap: wrap; 
            gap: 8px 12px; 
            margin-top: 5px;
            font-weight: normal; 
            color: var(--text-main);
        }
        .material-item {
            display: flex;
            align-items: center;
            background: #ffffff;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid var(--border-tan);
            font-weight: bold;
            color: var(--point-pink); 
            white-space: nowrap;
            /* ì•„ì´ì½˜ ì œê±°ë¡œ ì¸í•´ margin-right ì¡°ì • ë¶ˆí•„ìš” */
        }
        /* .material-icon CSS ë¸”ë¡ ì œê±°ë¨ (ìš”ì²­ ë°˜ì˜) */
        
        .level-unlocks {
            font-size: 0.85rem;
            line-height: 1.4;
            color: #555;
            font-style: italic;
            margin-top: 5px;
        }


        /* ---------------------------------- */
        /* ğŸ’¡ ëª¨ë°”ì¼ ë¯¸ë””ì–´ ì¿¼ë¦¬ (768px ì´í•˜) */
        /* ---------------------------------- */
        @media (max-width: 768px) {
            
            body {
                flex-direction: column; 
                height: auto; 
                overflow-y: auto; 
                padding-top: 200px;
            }
            
            /* 1. ìµœìƒë‹¨ ê³ ì • í—¤ë” (ëª¨ë°”ì¼) */
            #fixed-header-container {
                left: 0; 
                width: 100%;
                height: auto; 
                min-height: auto;
                padding: 10px 15px; 
            }
            .filter-group { gap: 5px 10px; justify-content: center; }

            /* í•„í„° ë¼ë²¨ì˜ ìµœì†Œ ë„ˆë¹„ë¥¼ ì¤„ì—¬ ê³µê°„ í™•ë³´ */
            .filter-label { 
                min-width: 35px; 
            }
            
            /* 2. ì‚¬ì´ë“œë°” (ìœ„ì‹œë¦¬ìŠ¤íŠ¸) */
            #sidebar {
                position: relative; 
                top: auto; left: auto;
                width: 100%;
                height: auto; 
                overflow: visible; 
                min-height: auto; 
                box-shadow: none;
                border-bottom: 1px solid var(--border-tan);
                z-index: 1; 
            }
            .scrollable-content { padding-bottom: 10px; }
            .logo-container { display: none; }
            #reset-container-desktop { display: none; }
            
            #sidebar-section-header { margin-top: 10px; }
            
            /* 3. ë©”ì¸ ì½˜í…ì¸  */
            .main-content {
                margin-left: 0; 
                padding: 10px; 
                padding-bottom: calc(var(--fixed-height-mobile) + var(--padding-base)); 
                overflow-y: visible; 
            }

            .mobile-separator { display: block; }
            .acquisition-list-header { 
                display: block; 
                margin-bottom: 10px; 
                font-family: 'Orbitron', sans-serif;
                font-size: 1rem;
                color: var(--point-blue);
                border-bottom: 2px solid var(--border-tan);
                padding-bottom: 5px;
                text-align: center;
            }

            /* 4. ëª¨ë°”ì¼ í•˜ë‹¨ ê³ ì • ë²„íŠ¼ */
            #reset-container-mobile {
                display: flex; 
                gap: 10px;    
                align-items: center; 
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                background: var(--sidebar-ivory); 
                padding: 10px 20px; 
                box-shadow: 0 -4px 10px rgba(0,0,0,0.1);
                z-index: 150;
                box-sizing: border-box; 
            }
            #reset-container-mobile .btn-show-modal { position: relative; }
            #reset-container-mobile .btn-show-modal > .item-count-badge {
                top: -8px; right: -8px; 
                font-size: 0.6rem; padding: 4px 8px; min-width: 35px;
            }

            .btn-show-modal, .btn-reset {
                flex-grow: 1; 
                width: auto;  
                margin-bottom: 0; 
            }
            
            /* 5. ë©”ì¸ ê·¸ë¦¬ë“œ 3ì—´ */
            .grid { 
                grid-template-columns: repeat(3, 1fr); 
                gap: 8px; 
                padding: 0 5px; 
            }
            
            /* ë©”ì¸ ì¹´ë“œ ëª¨ë°”ì¼ ìµœì í™” */
            .card { padding: 10px 5px; }
            .card::before { font-size: 0.5rem; padding: 1px 8px; top: 8px; } 
            .img-box { width: 50px; height: 50px; margin: 15px auto 5px; } 
            .name { 
                font-size: 0.75rem; 
                min-height: 35px; 
                margin-bottom: 3px; 
            } 
            /* ìŠ¤íƒ ì¹´ìš´íŠ¸ ë°°ì§€ ìŠ¤íƒ€ì¼ */
            .stack-badge {
                font-size: 0.55rem;
                padding: 1px 4px;
                margin-top: 2px;
            }
            .price { font-size: 0.85rem; } 
            .tier-line { margin-top: 10px; height: 4px; }

            /* 6. ì‚¬ì´ë“œë°” ìœ„ì‹œë¦¬ìŠ¤íŠ¸ 3ì—´ë¡œ ìˆ˜ì • ë° ìµœì í™” */
            #wishlist { 
                display: grid; 
                grid-template-columns: repeat(3, 1fr); 
                gap: 8px; 
                margin-bottom: 10px !important; 
            }
            .wishlist-item { 
                padding: 5px; 
                display: flex;
                flex-direction: column; 
                align-items: center; 
                text-align: center;
                gap: 3px; 
            }
            .wish-icon { 
                width: 35px; 
                height: 35px; 
                margin-bottom: 0;
            }
            .wishlist-item > div { width: 100%; }
            .wishlist-item > div > div:first-child { font-size: 0.7rem; font-weight: bold; line-height: 1.2; height: 1.2rem; overflow: hidden;}
            .wishlist-item > div > div:last-child { font-size: 0.65rem; font-weight: bold; }
            
            /* 7. ëª¨ë‹¬ ê³µí†µ ëª¨ë°”ì¼ ìµœì í™” */
            .modal-content { width: 95%; padding: 15px; }
            .modal-header { flex-direction: column; align-items: flex-start; }
            .modal-header-title { margin-bottom: 5px; font-size: 1.1rem; }
            #modal-total-value-display { font-size: 1.3rem; text-align: left; margin-left: 0; }
            
            #modal-wishlist-content { 
                grid-template-columns: repeat(3, 1fr); 
                gap: 8px; 
            }
            .modal-item-card { padding: 8px 4px; }
            .modal-item-icon { width: 45px; height: 45px; margin-bottom: 5px; }
            .modal-item-name { 
                font-size: 0.7rem; 
                min-height: 30px; 
                margin-bottom: 2px;
            }
            .modal-item-price { font-size: 0.8rem; }
            
            /* íš¨ìœ¨í‘œ ëª¨ë°”ì¼ ìµœì í™” */
            .modal-efficiency-grid {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            .efficiency-rank { font-size: 1.1rem; width: 25px; } 
            .efficiency-name { font-size: 0.9rem; }
            .efficiency-value { font-size: 1.0rem; }
            .efficiency-detail { font-size: 0.7rem; }
            .efficiency-item-card { padding: 8px 10px; }
            
            /* ì¬ë£Œ ëª¨ë‹¬ ëª¨ë°”ì¼ ìµœì í™” */
            #modal-materials-content {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            .station-card { padding: 10px; }
            .station-header { font-size: 1rem; }
            .station-role, .level-unlocks { font-size: 0.8rem; }
            .level-materials { font-size: 0.8rem; }
            /* .material-icon CSS ì œê±°ì— ë”°ë¼ ê´€ë ¨ ëª¨ë°”ì¼ ìŠ¤íƒ€ì¼ë„ ë¶ˆí•„ìš” */
            .material-item { font-size: 0.8rem; }
        }
    </style>
</head>
<body>

<div id="fixed-header-container">
    <div class="net-worth-box">
        <div class="net-worth-label">TOTAL COIN</div>
        <div class="total-value" id="total-value-display">0 Coin</div>
    </div>

    <div class="search-group">
        <button id="go-top-button" onclick="scrollToTop()">â–²</button>
        <input type="text" id="searchInput" placeholder="Search for items..." >
    </div>
    
    <div id="filter-container">
        </div>
</div>

<aside id="sidebar">
    <div class="logo-container">
        <img src="logo.png" alt="ARC RAIDERS" onerror="this.src='https://via.placeholder.com/340x180';">
    </div>
    
    <div class="scrollable-content">
        <div class="section-header" id="sidebar-section-header">TARGET ITEMS</div>
        <div id="wishlist"></div>
    </div>

    <div id="reset-container-desktop"> 
        <button class="btn-show-modal" onclick="openModal()">
            VIEW TARGET LIST
            <span id="item-count-badge-desktop" class="item-count-badge">0 / 0</span>
        </button>
        <button class="btn-show-modal" style="background: #27ae60;" onclick="openMaterialsModal()">
            VIEW CRAFTING MATERIALS
        </button>
        <button class="btn-reset" onclick="clearStorage()">RESET</button>
    </div>
</aside>

<main class="main-content" id="main-content">
    
    <div class="mobile-separator"></div>
    <div class="acquisition-list-header">
         ITEM LIST 
    </div>

    <div class="grid" id="mainGrid"></div>
</main>

<div id="reset-container-mobile">
    <button class="btn-show-modal" onclick="openModal()">
        VIEW TARGET LIST
        <span id="item-count-badge-mobile" class="item-count-badge">0 / 0</span>
    </button>
     <button class="btn-show-modal" style="background: #27ae60;" onclick="openMaterialsModal()">
        VIEW MATERIALS
    </button>
    <button class="btn-reset" onclick="clearStorage()">RESET</button>
</div>

<script src="data.js"></script>

<script>
    const IMAGE_FOLDER = "arc_raiders_images";
    const STORAGE_KEY = "arc_Unified_Ivory_Final";
    const FILTER_STORAGE_KEY = "arc_Unified_Ivory_Filters";
    
    const mainGrid = document.getElementById('mainGrid');
    const sidebarWishlist = document.getElementById('wishlist');
    const searchInput = document.getElementById('searchInput');
    const filterContainer = document.getElementById('filter-container');
    const goTopButton = document.getElementById('go-top-button');
    const totalValueDisplay = document.getElementById('total-value-display');
    const itemCountBadgeDesktop = document.getElementById('item-count-badge-desktop');
    const itemCountBadgeMobile = document.getElementById('item-count-badge-mobile');

    const FILTER_OPTIONS = {
        'Tier': ['S', 'A', 'B', 'C', 'D'], 
    };

    let selectedItems = new Set();
    let activeFilters = {}; 

    // ----------------------------------------------------
    // ğŸ’¡ [ìˆ˜ì •ëœ ë°ì´í„°] ì œì‘ì†Œ ì—…ê·¸ë ˆì´ë“œ ì¬ë£Œ ë¦¬ìŠ¤íŠ¸ (ì´ë¦„ë§Œ data.js ê¸°ì¤€ìœ¼ë¡œ í‘œì¤€í™”)
    // ----------------------------------------------------
    const UPGRADE_MATERIALS = [
        {
            name: "ì´ê¸° ì œì‘ì†Œ",
            en_name: "Gunsmith Station",
            role: "ëª¨ë“  ë¬´ê¸° ì œì‘ ë° ê°œì¡° ë‹´ë‹¹. ì—…ê·¸ë ˆì´ë“œ ì‹œ ìƒìœ„ ë¬´ê¸°ì™€ ê³ ê¸‰ ë¶€ì°©ë¬¼ ì„¤ê³„ë„ í•´ê¸ˆ.",
            levels: [
                { level: 1, materials: [
                    { name: "Metal Parts", kr_name: "ê¸ˆì† ë¶€í’ˆ", count: 20 }, 
                    { name: "Rubber Parts", kr_name: "ê³ ë¬´ ë¶€í’ˆ", count: 30 }
                ], unlocks: "ê¸°ë³¸ ë¬´ê¸° ì œì‘ ê°€ëŠ¥" },
                { level: 2, materials: [
                    { name: "Rusty Tool", kr_name: "ë…¹ìŠ¨ ë„êµ¬", count: 3 }, 
                    { name: "Mechanical Parts", kr_name: "ê¸°ê³„ ë¶€í’ˆ", count: 5 }, 
                    { name: "Wasp Driver", kr_name: "ì™€ìŠ¤í”„ ë“œë¼ì´ë²„", count: 8 }
                ], unlocks: "ë¬´ê¸° ì¢…ë¥˜ í™•ì¥, ë¶€ì°©ë¬¼ í–¥ìƒ" },
                { level: 3, materials: [
                    { name: "Rusty Gear", kr_name: "ë…¹ìŠ¨ í†±ë‹ˆë°”í€´", count: 3 }, 
                    { name: "Advanced Mechanical Parts", kr_name: "ê³ ê¸‰ ê¸°ê³„ ë¶€í’ˆ", count: 5 }, 
                    { name: "Sentinel Launch Core", kr_name: "ì„¼í‹°ë„¬ ë°œì‚¬ ì½”ì–´", count: 4 }
                ], unlocks: "ì—í”½ ë¬´ê¸°, 3ë‹¨ê³„ ê°œì¡° í•´ê¸ˆ" }
            ]
        },
        {
            name: "ì¥ë¹„ ì‘ì—…ëŒ€",
            en_name: "Gear Bench",
            role: "ë°©ì–´ë§‰ ë° ìŠˆíŠ¸ ì œì‘. ë°©ì–´ë ¥ì„ ê²°ì •ì§“ëŠ” í•µì‹¬ ì„¤ë¹„.",
            levels: [
                { level: 1, materials: [
                    { name: "Plastic Parts", kr_name: "í”Œë¼ìŠ¤í‹± ë¶€í’ˆ", count: 25 }, 
                    { name: "Fabric", kr_name: "ì§ë¬¼", count: 30 }
                ], unlocks: "ê²½ëŸ‰Â·ì¤€ì¤‘ëŸ‰ ì‹¤ë“œ, ê¸°ë³¸ ê°•í™” ìŠˆíŠ¸" },
                { level: 2, materials: [
                    { name: "Power Cable", kr_name: "ì „ì› ì¼€ì´ë¸”", count: 3 }, 
                    { name: "Electrical Parts", kr_name: "ì „ê¸° ë¶€í’ˆ", count: 5 }, 
                    { name: "Wasp Driver", kr_name: "ì™€ìŠ¤í”„ ë“œë¼ì´ë²„", count: 5 }
                ], unlocks: "ì¤‘ëŸ‰ ì‹¤ë“œ, ë§ˆí¬2" },
                { level: 3, materials: [
                    { name: "Industrial Battery", kr_name: "ì‚°ì—…ìš© ë°°í„°ë¦¬", count: 3 }, 
                    { name: "Advanced Electrical Parts", kr_name: "ê³ ê¸‰ ì „ê¸° ë¶€í’ˆ", count: 5 }, 
                    { name: "Bastion Cell", kr_name: "ë°”ìŠ¤í‹°ì˜¨ ì „ì§€", count: 6 }
                ], unlocks: "ë§ˆí¬3, ê³ ê¸‰ ê°•í™” ìŠˆíŠ¸" }
            ]
        },
        {
            name: "í­ë°œë¬¼ ìŠ¤í…Œì´ì…˜",
            en_name: "Explosives Station",
            role: "ì œì–´ìš© ë° ì§€ì—­ ë´‰ì‡„ìš© í­ë°œë¬¼ ì œì‘. ì—…ê·¸ë ˆì´ë“œ ì‹œ íŠ¹ìˆ˜ íš¨ê³¼ ìˆ˜ë¥˜íƒ„ ì œì‘ ê°€ëŠ¥.",
            levels: [
                { level: 1, materials: [
                    { name: "Chemicals", kr_name: "í™”í•™í’ˆ", count: 50 }, 
                    { name: "Arc Alloy", kr_name: "ì•„í¬í•©ê¸ˆ", count: 6 }
                ], unlocks: "ê°€ìŠ¤ ìˆ˜ë¥˜íƒ„, ê²½ëŸ‰ ì¶©ëŒ ìˆ˜ë¥˜íƒ„" },
                { level: 2, materials: [
                    { name: "Synthetic Fuel", kr_name: "í•©ì„± ì—°ë£Œ", count: 3 }, 
                    { name: "Crude Explosive", kr_name: "ì¡°ì¡í•œ í­ì•½", count: 5 }, 
                    { name: "Pop Trigger", kr_name: "íŒ íŠ¸ë¦¬ê±°", count: 5 }
                ], unlocks: "í™”ì—¼ í”¼í•´ ìˆ˜ë¥˜íƒ„" },
                { level: 3, materials: [
                    { name: "Lab Reagent", kr_name: "ì—°êµ¬ì‹¤ ì‹œì•½", count: 3 }, 
                    { name: "Mixed Powder", kr_name: "í˜¼í•© í™”ì•½", count: 5 }, 
                    { name: "Rocketeer Driver", kr_name: "ë¡œì¼“í‹°ì–´ ë“œë¼ì´ë²„", count: 3 }
                ], unlocks: "ì¤‘ëŸ‰ ì‹ ê´€ ìˆ˜ë¥˜íƒ„" }
            ]
        },
        {
            name: "ìœ í‹¸ë¦¬í‹° ìŠ¤í…Œì´ì…˜",
            en_name: "Utility Station",
            role: "ì •ì°°, ì´ë™, êµë€ ë“± ë‹¤ì–‘í•œ ì „ìˆ  ì¥ë¹„ ì œì‘.",
            levels: [
                { level: 1, materials: [
                    { name: "Plastic Parts", kr_name: "í”Œë¼ìŠ¤í‹± ë¶€í’ˆ", count: 50 }, 
                    { name: "Arc Alloy", kr_name: "ì•„í¬í•©ê¸ˆ", count: 6 }
                ], unlocks: "ìŒì•ˆê²½, ë¬¸ ì ê¸ˆ ì¥ì¹˜, ì—°ë§‰íƒ„" },
                { level: 2, materials: [
                    { name: "Damaged Heatsink", kr_name: "ì†ìƒëœ íˆíŠ¸ ì‹±í¬", count: 2 }, 
                    { name: "Electrical Parts", kr_name: "ì „ê¸° ë¶€í’ˆ", count: 5 }, 
                    { name: "Snitch Scanner", kr_name: "ìŠ¤ë‹ˆì¹˜ ìŠ¤ìºë„ˆ", count: 6 }
                ], unlocks: "ìœ ì¸ ìˆ˜ë¥˜íƒ„" },
                { level: 3, materials: [
                    { name: "Damaged Motherboard", kr_name: "ì†ìƒëœ ë§ˆë”ë³´ë“œ", count: 3 }, 
                    { name: "Advanced Electrical Parts", kr_name: "ê³ ê¸‰ ì „ê¸° ë¶€í’ˆ", count: 5 }, 
                    { name: "Ripper Pulse Unit", kr_name: "ë¦¬í¼ í„ìŠ¤ ìœ ë‹›", count: 4 }
                ], unlocks: "ìŠ¤ëƒ… í›…, í‘œì‹ ìˆ˜ë¥˜íƒ„" }
            ]
        },
        {
            name: "ì˜ì•½í’ˆ ì—°êµ¬ì‹¤",
            en_name: "Medical Lab",
            role: "ì¹˜ìœ  ì•„ì´í…œê³¼ ì˜ì•½í’ˆ ì œì‘ì†Œ. ë ˆë²¨ì´ ì˜¬ë¼ê°ˆìˆ˜ë¡ ë” ë¹ ë¥¸ íšŒë³µ ì•„ì´í…œê³¼ íš¨ìœ¨ì ì¸ ì†Œëª¨í’ˆ ì œì‘ ê°€ëŠ¥.",
            levels: [
                { level: 1, materials: [
                    { name: "Fabric", kr_name: "ì§ë¬¼", count: 50 }, 
                    { name: "Arc Alloy", kr_name: "ì•„í¬í•©ê¸ˆ", count: 6 }
                ], unlocks: "ê¸°ë³¸ ì˜ë£Œ ì•„ì´í…œ" },
                { level: 2, materials: [
                    { name: "Broken Bioscanner", kr_name: "ê¹¨ì§„ ë°”ì´ì˜¤ìŠ¤ìºë„ˆ", count: 2 }, 
                    { name: "Tough Fabric", kr_name: "ì§ˆê¸´ ì²œ", count: 5 }, 
                    { name: "Tick Pod", kr_name: "í‹± í¬ë“œ", count: 8 }
                ], unlocks: "ê³ ê¸‰ ì¹˜ìœ  ì•„ì´í…œ" },
                { level: 3, materials: [
                    { name: "Closed Medical Box", kr_name: "ë‹«íŒ ì˜ë£Œìƒì", count: 3 }, 
                    { name: "Disinfectant", kr_name: "ì†Œë…ì•½", count: 8 }, 
                    { name: "Surveyor Bolt Part", kr_name: "ì„œë² ì´ì–´ ë³¼íŠ¸ ë¶€í’ˆ", count: 5 }
                ], unlocks: "ì¦‰ì‹œ ì¹˜ìœ  ì•„ì´í…œ" }
            ]
        },
        {
            name: "ê°€ê³µê¸°",
            en_name: "Refiner Station",
            role: "ê¸°ë³¸ ìì›ì„ í¬ê·€ ìì›ìœ¼ë¡œ ë³€í™˜. ë†ì‚¬Â·íŒŒë° ë¶€ë‹´ì„ ì¤„ì—¬ì£¼ëŠ” í•µì‹¬ ì„¤ë¹„.",
            levels: [
                { level: 1, materials: [
                    { name: "Metal Parts", kr_name: "ê¸ˆì† ë¶€í’ˆ", count: 60 }, 
                    { name: "Arc Power Cell", kr_name: "ì•„í¬ íŒŒì›Œì…€", count: 5 }
                ], unlocks: "ì „ê¸° ë¶€í’ˆ, ì¡°ì•…í•œ í­ë°œë¬¼, ê¸°ê³„ ë¶€í’ˆ" },
                { level: 2, materials: [
                    { name: "Toaster", kr_name: "í† ìŠ¤í„°", count: 3 }, 
                    { name: "Arc Motion Core", kr_name: "ì•„í¬ ëª¨ì…˜ ì½”ì–´", count: 5 }, 
                    { name: "Fireball Burner", kr_name: "íŒŒì´ì–´ë³¼ ë²„ë„ˆ", count: 8 }
                ], unlocks: "ê³ ê¸‰ ë¶€í’ˆ, ì´ê¸° ë¶€í’ˆ" },
                { level: 3, materials: [
                    { name: "Motor", kr_name: "ëª¨í„°", count: 3 }, 
                    { name: "Arc Circuit", kr_name: "ì•„í¬ íšŒë¡œ", count: 10 }, 
                    { name: "Bombardier Cell", kr_name: "ë´„ë°”ë””ì–´ ì „ì§€", count: 6 }
                ], unlocks: "ëª¨ë“œ ë¶€í’ˆ, íŒŒì›Œ ë¡œë“œ" }
            ]
        },
        {
            name: "ê¼¬ê¼¬",
            en_name: "KkoKko",
            role: "ê¸°ë³¸ ìì›ì„ ì±„ì§‘. ë ˆë²¨ì´ ì˜¬ë¼ê°ˆìˆ˜ë¡ ë” ë§ì€ ê¸°ë³¸ì¬ë£Œë¥¼ ì±„ì§‘.",
            levels: [
                { level: 2, materials: [
                    { name: "Dog Collar", kr_name: "ê°œ ëª©ê±¸ì´", count: 1 } 
                ], unlocks: "" },
                { level: 3, materials: [
                    { name: "Lemon", kr_name: "ë ˆëª¬", count: 3 }, 
                    { name: "Apricot", kr_name: "ì‚´êµ¬", count: 3 }
                ], unlocks: "" },
                { level: 4, materials: [
                    { name: "Cactus", kr_name: "ì„ ì¸ì¥", count: 6 }, 
                    { name: "Olive", kr_name: "ì˜¬ë¦¬ë¸Œ", count: 6 }, 
                    { name: "Cat Bed", kr_name: "ê³ ì–‘ì´ ì¹¨ëŒ€", count: 1 } 
                ], unlocks: "" },
                { level: 5, materials: [
                    { name: "Mushroom", kr_name: "ë²„ì„¯", count: 12 }, 
                    { name: "Apricot", kr_name: "ì‚´êµ¬", count: 12 }, 
                    { name: "Very Comfortable Pillow", kr_name: "ë§¤ìš° í¸ì•ˆí•œ ë² ê°œ", count: 3 }
                ], unlocks: "" }
            ]
        }
    ];

    // ----------------------------------------------------
    // Main Logic Functions
    // ----------------------------------------------------

    // í•„í„° ìƒì„± ë° ì´ˆê¸°í™” (â—ëŠë‚Œí‘œ ì•„ì´ì½˜ ìœ„ì¹˜ ìˆ˜ì • ì™„ë£Œ)
    function setupFilters() {
        const html = Object.entries(FILTER_OPTIONS).map(([group, options]) => {
            // Tier ê·¸ë£¹ì¼ ë•Œë§Œ ëª¨ë‹¬ í˜¸ì¶œ ê¸°ëŠ¥ ì¶”ê°€
            const exclamationIcon = (group === 'Tier') 
                ? `<span style="color:var(--point-pink); margin-left:5px; font-weight:bold; font-size:1.1rem; cursor:pointer;" 
                       onclick="openEfficiencyModal()" 
                       title="Stackë‹¹ ì½”ì¸ íš¨ìœ¨ ìˆœìœ„ ë³´ê¸°">!</span>`
                : `<span style="color:var(--point-pink); margin-left:5px; font-weight:bold; font-size:1.1rem;">!</span>`;

            return `
                <div class="filter-group">
                    <div class="filter-label">
                        ${group} 
                        ${exclamationIcon} </div>
                    <label class="filter-option">
                        <input type="checkbox" data-group="${group}" data-value="ALL" onchange="handleFilterChange(this)">
                        ALL
                    </label>
                    ${options.map(option => `
                        <label class="filter-option">
                            <input type="checkbox" data-group="${group}" data-value="${option}" onchange="handleFilterChange(this)">
                            ${option}
                        </label>
                    `).join('')}
                </div>
            `;
        }).join('<div style="width:100%; height:1px; background:#f2ede4; margin:5px 0;"></div>');

        filterContainer.innerHTML = html;
        loadFilters();
    }

    // í•„í„° ë³€ê²½ ì²˜ë¦¬ (ALL ì˜µì…˜ ë¡œì§ í¬í•¨í•˜ì—¬ ìˆ˜ì •)
    function handleFilterChange(checkbox) {
        const group = checkbox.dataset.group;
        const value = checkbox.dataset.value;
        // ALLì„ ì œì™¸í•œ í‹°ì–´ ì²´í¬ë°•ìŠ¤ë“¤
        const tierCheckboxes = document.querySelectorAll(`input[data-group="${group}"]:not([data-value="ALL"])`);
        const allCheckbox = document.querySelector(`input[data-group="${group}"][data-value="ALL"]`);

        if (!activeFilters[group]) {
            activeFilters[group] = new Set();
        }

        if (value === 'ALL') {
            // ALL ì²´í¬ë°•ìŠ¤ í´ë¦­
            if (checkbox.checked) {
                // ALL ì„ íƒ ì‹œ, ëª¨ë“  í‹°ì–´ ì²´í¬ í•´ì œ ë° activeFilters í´ë¦¬ì–´
                tierCheckboxes.forEach(cb => cb.checked = false);
                activeFilters[group].clear();
            } else {
                // ALL í•´ì œ ë°©ì§€ (ë‹¤ë¥¸ í‹°ì–´ê°€ ì„ íƒë˜ì§€ ì•Šì€ ê²½ìš°)
                if (activeFilters[group].size === 0) {
                    checkbox.checked = true;
                    return; // ìƒíƒœ ë³€í™” ì—†ìŒ
                }
            }
        } else {
            // í‹°ì–´ ì²´í¬ë°•ìŠ¤ í´ë¦­ (S, A, B, C, D)
            if (checkbox.checked) {
                activeFilters[group].add(value);
                // í‹°ì–´ ì„ íƒ ì‹œ, ALL ì²´í¬ í•´ì œ
                if (allCheckbox) allCheckbox.checked = false;
            } else {
                activeFilters[group].delete(value);
                // ë§ˆì§€ë§‰ í‹°ì–´ê°€ í•´ì œë˜ë©´, ALL ìë™ ì„ íƒ
                if (activeFilters[group].size === 0) {
                    if (allCheckbox) allCheckbox.checked = true;
                }
            }
        }
        
        saveFilters();
        renderGrid();
    }

    // í•„í„° ì €ì¥
    function saveFilters() {
        const serializableFilters = {};
        for (const [group, values] of Object.entries(activeFilters)) {
            serializableFilters[group] = Array.from(values);
        }
        localStorage.setItem(FILTER_STORAGE_KEY, JSON.stringify(serializableFilters));
    }

    // í•„í„° ë¡œë“œ (ALL ì˜µì…˜ ë¡œì§ í¬í•¨í•˜ì—¬ ìˆ˜ì •)
    function loadFilters() {
        const savedFilters = JSON.parse(localStorage.getItem(FILTER_STORAGE_KEY));
        
        if (savedFilters) {
            activeFilters = {};
            for (const [group, values] of Object.entries(savedFilters)) {
                activeFilters[group] = new Set(values);
                
                // 1. ê°œë³„ í‹°ì–´ ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì„¤ì •
                values.forEach(value => {
                    const checkbox = document.querySelector(`input[data-group="${group}"][data-value="${value}"]`);
                    if (checkbox) {
                        checkbox.checked = true;
                    }
                });
                
                // 2. ALL ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì„¤ì •
                const allCheckbox = document.querySelector(`input[data-group="${group}"][data-value="ALL"]`);
                if (activeFilters[group].size === 0) {
                    // ì„ íƒëœ í‹°ì–´ê°€ ì—†ìœ¼ë©´ ALL ì²´í¬
                    if (allCheckbox) allCheckbox.checked = true;
                } else {
                    // ì„ íƒëœ í‹°ì–´ê°€ ìˆìœ¼ë©´ ALL ì²´í¬ í•´ì œ
                    if (allCheckbox) allCheckbox.checked = false;
                }
            }
        } else {
             // ìµœì´ˆ ë¡œë“œ ì‹œ activeFiltersê°€ ë¹„ì–´ ìˆìœ¼ë¯€ë¡œ, ëª¨ë“  ê·¸ë£¹ì˜ ALLì„ ì²´í¬
             Object.keys(FILTER_OPTIONS).forEach(group => {
                const allCheckbox = document.querySelector(`input[data-group="${group}"][data-value="ALL"]`);
                if (allCheckbox) {
                    allCheckbox.checked = true;
                }
             });
        }
    }

    // ë©”ì¸ ê·¸ë¦¬ë“œ ë Œë”ë§
    function renderGrid() {
        const searchQuery = searchInput.value.toLowerCase();
        let filteredItems = lootItems.filter(item => {
            // 1. ê²€ìƒ‰ í•„í„°
            const matchesSearch = item.kr_name.toLowerCase().includes(searchQuery) || 
                                  item.name.toLowerCase().includes(searchQuery);

            if (!matchesSearch) return false;

            // 2. ë“±ê¸‰ í•„í„°
            // activeFilters.Tierê°€ ì¡´ì¬í•˜ê³ , í¬ê¸°ê°€ 0ë³´ë‹¤ í¬ë©´ í•„í„°ë§ì„ ì ìš©í•©ë‹ˆë‹¤. 
            // activeFilters.Tierì˜ í¬ê¸°ê°€ 0ì´ë©´ (ALLì´ ì„ íƒëœ ìƒíƒœ) í•„í„°ë§ì„ ê±´ë„ˆë›°ë„ë¡ í•©ë‹ˆë‹¤.
            if (activeFilters.Tier && activeFilters.Tier.size > 0) {
                if (!activeFilters.Tier.has(item.tier)) {
                    return false;
                }
            }

            return true;
        });

        // ê°€ê²© ì—­ìˆœ ì •ë ¬
        filteredItems.sort((a, b) => b.price - a.price);

        mainGrid.innerHTML = filteredItems.map(item => {
            const safeName = item.name.replace(/[\\/:*?"<>|]/g, '');
            const isChecked = selectedItems.has(item.id);
            const stackBadge = item.stack > 1 ? `<span class="stack-badge">Stack ${item.stack}</span>` : '';
            
            return `
                <div class="card ${item.tier} ${isChecked ? 'checked' : ''}" data-id="${item.id}" onclick="toggleSelect(${item.id})">
                    <div class="img-box">
                        <img src="${IMAGE_FOLDER}/${safeName}.webp" alt="${item.kr_name}" class="item-icon" onerror="this.src='https://via.placeholder.com/80';">
                    </div>
                    <div class="name">${item.kr_name}<br>${stackBadge}</div>
                    <div class="price">${item.price.toLocaleString()} Coin</div>
                    <div class="tier-line"></div>
                </div>
            `;
        }).join('');

        // ê²€ìƒ‰/í•„í„° ê²°ê³¼ê°€ ì—†ëŠ” ê²½ìš° ì²˜ë¦¬
        if (filteredItems.length === 0) {
             mainGrid.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 50px; color: #8c8c8c;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
        }
    }

    // ì•„ì´í…œ ì„ íƒ/í•´ì œ í† ê¸€
    function toggleSelect(id) {
        if (selectedItems.has(id)) {
            selectedItems.delete(id);
        } else {
            selectedItems.add(id);
        }
        saveSelectedItems();
        renderGrid();
        renderWishlist();
        updateTotalValue();
    }

    // ì„ íƒëœ ì•„ì´í…œ ì €ì¥
    function saveSelectedItems() {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(Array.from(selectedItems)));
    }

    // ì„ íƒëœ ì•„ì´í…œ ë¡œë“œ
    function loadSelectedItems() {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
            selectedItems = new Set(JSON.parse(saved).map(Number));
        }
    }

    // ì´ ê°€ì¹˜ ì—…ë°ì´íŠ¸
    function updateTotalValue() {
        let totalValue = 0;
        let totalItems = 0;
        selectedItems.forEach(id => {
            const item = lootItems.find(i => i.id === id);
            if (item) {
                totalValue += item.price;
                totalItems++;
            }
        });
        
        totalValueDisplay.textContent = totalValue.toLocaleString() + ' Coin';
        
        const totalLootItems = lootItems.length;
        const badgeText = `${totalItems} / ${totalLootItems}`;
        
        itemCountBadgeDesktop.textContent = badgeText;
        itemCountBadgeMobile.textContent = badgeText;

        // ì•„ì´í…œ ê°œìˆ˜ê°€ 1ê°œ ì´ìƒì´ë©´ ë°°ì§€ í‘œì‹œ
        if (totalItems > 0) {
            itemCountBadgeDesktop.style.display = 'block';
            itemCountBadgeMobile.style.display = 'block';
        } else {
            itemCountBadgeDesktop.style.display = 'none';
            itemCountBadgeMobile.style.display = 'none';
        }
    }

    // ì‚¬ì´ë“œë°” ìœ„ì‹œë¦¬ìŠ¤íŠ¸ ë Œë”ë§
    function renderWishlist() {
        sidebarWishlist.innerHTML = Array.from(selectedItems).map(id => {
            const item = lootItems.find(i => i.id === id);
            if (!item) return '';

            const safeName = item.name.replace(/[\\/:*?"<>|]/g, '');
            return `
                <div class="wishlist-item" onclick="toggleSelect(${item.id})">
                    <img src="${IMAGE_FOLDER}/${safeName}.webp" alt="${item.kr_name}" class="wish-icon" onerror="this.src='https://via.placeholder.com/40';">
                    <div>
                        <div>${item.kr_name}</div>
                        <div>${item.price.toLocaleString()} Coin</div>
                    </div>
                </div>
            `;
        }).join('');
        
        // "ì„ íƒëœ ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤" í…ìŠ¤íŠ¸ ì œê±° ìš”ì²­ ë°˜ì˜ (ì´ì „ ë‹¨ê³„ì—ì„œ ì´ë¯¸ ë°˜ì˜ë¨)
    }

    // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì´ˆê¸°í™”
    function clearStorage() {
        if (confirm("ì„ íƒëœ ëª¨ë“  ì•„ì´í…œ ëª©ë¡ê³¼ í•„í„° ì„¤ì •ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            localStorage.removeItem(STORAGE_KEY);
            localStorage.removeItem(FILTER_STORAGE_KEY);
            selectedItems = new Set();
            activeFilters = {};
            document.querySelectorAll('#filter-container input[type="checkbox"]').forEach(cb => cb.checked = false);
            searchInput.value = '';
            
            // í•„í„° ì´ˆê¸°í™” í›„, ALLì´ ë‹¤ì‹œ ì„ íƒë˜ë„ë¡ loadFilters í˜¸ì¶œ
            setupFilters(); 

            renderGrid();
            renderWishlist();
            updateTotalValue();
        }
    }

    // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ (Go-Top ë²„íŠ¼)
    function handleScroll() {
        if (window.scrollY > 200) {
            goTopButton.classList.add('visible');
        } else {
            goTopButton.classList.remove('visible');
        }
    }

    function scrollToTop() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    // ----------------------------------------------------
    // Modals
    // ----------------------------------------------------

    // TARGET ITEM LIST MODAL
    function openModal() {
        const modal = document.getElementById('big-wishlist-modal');
        const modalContent = document.getElementById('modal-wishlist-content');
        const modalTotalValueDisplay = document.getElementById('modal-total-value-display');
        
        let totalValue = 0;

        modalContent.innerHTML = Array.from(selectedItems).map(id => {
            const item = lootItems.find(i => i.id === id);
            if (!item) return '';
            
            totalValue += item.price;
            const safeName = item.name.replace(/[\\/:*?"<>|]/g, '');

            return `
                <div class="modal-item-card ${item.tier}" onclick="toggleSelect(${item.id}); renderModalWishlist()">
                    <img src="${IMAGE_FOLDER}/${safeName}.webp" alt="${item.kr_name}" class="modal-item-icon" onerror="this.src='https://via.placeholder.com/70';">
                    <div class="modal-item-name">${item.kr_name}</div>
                    <div class="modal-item-price">${item.price.toLocaleString()} Coin</div>
                </div>
            `;
        }).join('');
        
        modalTotalValueDisplay.textContent = totalValue.toLocaleString() + ' Coin';
        
        if (selectedItems.size === 0) {
             modalContent.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; color: #8c8c8c; padding: 50px;">ì„ íƒëœ ì•„ì´í…œì´ ì—†ìŠµë‹ˆë‹¤.</div>';
        }

        modal.style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('big-wishlist-modal').style.display = 'none';
        renderWishlist(); // ëª¨ë‹¬ì—ì„œ ë³€ê²½ ì‚¬í•­ ë°˜ì˜
    }

    // ëª¨ë‹¬ ë‚´ë¶€ì—ì„œ ì•„ì´í…œ ì„ íƒ/í•´ì œ ì‹œ ëª¨ë‹¬ ì—…ë°ì´íŠ¸
    function renderModalWishlist() {
        openModal(); 
    }
    
    // COIN EFFICIENCY CHART MODAL
    function openEfficiencyModal() {
        const modal = document.getElementById('efficiency-modal');
        const modalContent = document.getElementById('modal-efficiency-content');
        
        const efficiencyItems = lootItems
            .filter(item => item.stack > 1) 
            .map(item => ({
                ...item,
                efficiency: item.price * item.stack 
            }))
            .sort((a, b) => b.efficiency - a.efficiency);

        modalContent.innerHTML = efficiencyItems.map((item, index) => {
            const safeName = item.name.replace(/[\\/:*?"<>|]/g, '');
            return `
                <div class="efficiency-item-card ${item.tier}">
                    <div class="efficiency-rank">${index + 1}</div>
                    <img src="${IMAGE_FOLDER}/${safeName}.webp" alt="${item.kr_name}" class="efficiency-icon" onerror="this.src='https://via.placeholder.com/40';">
                    <div class="efficiency-info">
                        <div class="efficiency-name">${item.kr_name} (${item.tier})</div>
                        <div class="efficiency-value">${item.efficiency.toLocaleString()} Coin</div>
                        <div class="efficiency-detail">${item.price.toLocaleString()} Coin Ã— Stack ${item.stack}</div>
                    </div>
                </div>
            `;
        }).join('');

        modal.style.display = 'flex';
    }

    function closeEfficiencyModal() {
        document.getElementById('efficiency-modal').style.display = 'none';
    }

    // ----------------------------------------------------
    // ğŸ’¡ NEW CRAFTING STATION MODAL (ì•„ì´ì½˜ ì œê±° ë°˜ì˜)
    // ----------------------------------------------------
    
    function openMaterialsModal() {
        const modal = document.getElementById('materials-modal');
        renderMaterialsModalContent();
        modal.style.display = 'flex';
    }

    function closeMaterialsModal() {
        document.getElementById('materials-modal').style.display = 'none';
    }

    function renderMaterialsModalContent() {
        const modalContent = document.getElementById('modal-materials-content');
        
        modalContent.innerHTML = UPGRADE_MATERIALS.map(station => {
            const levelsHtml = station.levels.map(level => {
                
                const materialsHtml = level.materials.map(mat => {
                    // ì•„ì´ì½˜(<img> íƒœê·¸)ì„ ì œê±°í•˜ê³  í…ìŠ¤íŠ¸ë§Œ ë Œë”ë§í•˜ë„ë¡ ìˆ˜ì • (ì´ì „ ìš”ì²­ ë°˜ì˜)
                    return `
                        <div class="material-item">
                            ${mat.kr_name} Ã— ${mat.count}
                        </div>
                    `;
                }).join('');

                return `
                    <div class="level-section">
                        <div class="level-header">LEVEL ${level.level}</div>
                        <div class="level-materials">${materialsHtml}</div>
                        ${level.unlocks ? `<div class="level-unlocks">ì£¼ìš” í•´ê¸ˆ: ${level.unlocks}</div>` : ''}
                    </div>
                `;
            }).join('');

            return `
                <div class="station-card">
                    <div class="station-header">${station.name} (${station.en_name})</div>
                    <div class="station-role">${station.role}</div>
                    ${levelsHtml}
                </div>
            `;
        }).join('');
    }
    
    // ----------------------------------------------------
    // Initialization
    // ----------------------------------------------------

    function init() {
        loadSelectedItems();
        setupFilters();
        renderGrid();
        renderWishlist();
        updateTotalValue();
    }

    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
    document.addEventListener('DOMContentLoaded', () => {
        
        init();

        searchInput.addEventListener('input', renderGrid);
        window.addEventListener('scroll', handleScroll);
        
        // ëª¨ë‹¬ ë‹«ê¸° ë¦¬ìŠ¤ë„ˆ (ì˜¤ë²„ë ˆì´ í´ë¦­ ì‹œ)
        const bigWishlistModal = document.getElementById('big-wishlist-modal');
        if (bigWishlistModal) {
            bigWishlistModal.addEventListener('click', (e) => {
                if (e.target === bigWishlistModal) {
                    closeModal();
                }
            });
        }
        
        const efficiencyModal = document.getElementById('efficiency-modal');
        if (efficiencyModal) {
            efficiencyModal.addEventListener('click', (e) => {
                if (e.target === efficiencyModal) {
                    closeEfficiencyModal();
                }
            });
        }
        
        // ğŸ’¡ NEW MODAL: ì œì‘ ìŠ¤í…Œì´ì…˜ ëª¨ë‹¬ ë‹«ê¸° ë¦¬ìŠ¤ë„ˆ
        const materialsModal = document.getElementById('materials-modal');
        if (materialsModal) {
            materialsModal.addEventListener('click', (e) => {
                if (e.target === materialsModal) {
                    closeMaterialsModal();
                }
            });
        }
    });

</script>

<div id="big-wishlist-modal" class="modal-overlay">
    <div class="modal-content">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <div class="modal-header">
            <div class="modal-header-title">TARGET ITEM LIST</div>
            <span id="modal-total-value-display">0 Coin</span>
        </div>
        <div id="modal-wishlist-content">
            </div>
    </div>
</div>

<div id="efficiency-modal" class="modal-overlay">
    <div class="modal-content">
        <span class="modal-close" onclick="closeEfficiencyModal()">&times;</span>
        <div class="modal-header">
            <div class="modal-header-title">COIN EFFICIENCY CHART</div>
            <span id="modal-efficiency-info">Stack Ã— Price = Efficiency</span>
        </div>
        <div id="modal-efficiency-content" class="modal-efficiency-grid">
            <div style="text-align:center; padding: 20px;">Loading efficiency data...</div>
        </div>
    </div>
</div>

<div id="materials-modal" class="modal-overlay">
    <div class="modal-content">
        <span class="modal-close" onclick="closeMaterialsModal()">&times;</span>
        <div class="modal-header">
            <div class="modal-header-title">CRAFTING STATION UPGRADES</div>
        </div>
        <div id="modal-materials-content">
            <div style="text-align:center; padding: 20px;">Loading crafting station data...</div>
        </div>
    </div>
</div>

</body>
</html>